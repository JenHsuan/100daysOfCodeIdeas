{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect, Fragment } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap';\nimport '../css/navbar.css';\nimport { selectShowPlannerState, selectLoginState, selectUsernameState } from './states/states';\nimport { setPlanner, setLogout, setUsername, setAccessToken, setEmail, setLogin, setFinishedArticles, setBookmarks, setProvider, setUserId } from './actions/articlesAction';\nimport Link from 'next/link';\nimport Router, { useRouter } from 'next/router';\n\nconst NavBar = () => {\n  const router = useRouter();\n  const disPatch = useDispatch();\n  const showPlannerFlag = useSelector(selectShowPlannerState);\n  const isLogin = useSelector(selectLoginState);\n  const username = useSelector(selectUsernameState);\n\n  const showPlanner = () => {\n    if (showPlannerFlag === true) {\n      console.log('Hide Planner');\n      disPatch(setPlanner(false));\n    } else {\n      console.log('Show Planner');\n      disPatch(setPlanner(true));\n    }\n  };\n\n  const SetLogoutForLocalSorage = () => {\n    localStorage.removeItem('bookmarks');\n    localStorage.removeItem('login');\n    localStorage.removeItem('username');\n    localStorage.removeItem('email');\n    localStorage.removeItem('finishedArticles');\n    localStorage.removeItem('token');\n    localStorage.removeItem('provider');\n  };\n\n  const SetLogout = () => {\n    disPatch(setLogout());\n    disPatch(setUsername(''));\n    disPatch(setUserId(-1));\n    disPatch(setEmail(''));\n    disPatch(setFinishedArticles([]));\n    disPatch(setAccessToken(''));\n    disPatch(setProvider(''));\n    disPatch(setBookmarks([]));\n  };\n\n  const SetLogin = (email, username) => {\n    if (email !== null && email !== undefined && email.length > 0) {\n      disPatch(setEmail(email)); //local storage\n\n      localStorage.setItem(\"email\", email);\n    }\n\n    if (username !== null && username !== undefined && username.length > 0) {\n      disPatch(setUsername(username)); //local storage\n\n      localStorage.setItem(\"username\", username);\n    }\n\n    disPatch(setLogin()); //local storage\n\n    localStorage.setItem(\"login\", \"true\");\n  };\n\n  useEffect(() => {\n    const login = localStorage.getItem(\"login\");\n\n    if (login !== null && login === 'true') {\n      const email = localStorage.getItem(\"email\");\n      const username = localStorage.getItem(\"username\");\n      SetLogin(email, username);\n    }\n  }, []);\n  useEffect(() => {\n    if (isLogin === false) {\n      disPatch(setUsername(''));\n    } else {\n      const username = localStorage.getItem(\"username\");\n      disPatch(setUsername(username));\n    }\n  }, [isLogin]);\n\n  const handleLogout = () => {\n    SetLogout();\n    SetLogoutForLocalSorage();\n\n    if (router.pathname !== 'signin') {\n      Router.push(`/signin`);\n    }\n  };\n\n  return __jsx(Navbar, {\n    bg: \"dark\",\n    expand: \"lg\",\n    variant: \"dark\",\n    fixed: \"top\"\n  }, __jsx(Navbar.Brand, {\n    href: \"/\"\n  }, __jsx(\"img\", {\n    src: \"https://raw.githubusercontent.com/JenHsuan/ALayman/master/views/images/alaymanicon.png\",\n    width: \"30\",\n    height: \"30\",\n    className: \"d-inline-block align-top navbar-logo-img\",\n    alt: \"Learning Booster\",\n    title: \"Learning Booster from Sean Hsieh\"\n  }), \"Daily Learning\"), __jsx(Navbar.Toggle, {\n    \"aria-controls\": \"basic-navbar-nav\"\n  }), __jsx(Navbar.Collapse, {\n    id: \"basic-navbar-nav\"\n  }, __jsx(Nav, {\n    className: \"mr-auto\"\n  }, __jsx(Nav.Link, {\n    href: \"about\"\n  }, __jsx(Link, {\n    href: \"/about\"\n  }, __jsx(\"a\", {\n    href: \"/about\"\n  }, \"About\"))), __jsx(Nav.Link, {\n    href: \"feed\"\n  }, __jsx(Link, {\n    href: \"/feed\"\n  }, __jsx(\"a\", {\n    href: \"/feed\"\n  }, \"RSS Feed\"))), isLogin && __jsx(Fragment, null, __jsx(Nav.Link, {\n    href: \"bookmarks\"\n  }, __jsx(Link, {\n    href: \"/bookmarks\"\n  }, __jsx(\"a\", {\n    href: \"/bookmarks\"\n  }, \"Plans\"))), __jsx(Nav.Link, {\n    href: \"achievements\"\n  }, __jsx(Link, {\n    href: \"/achievements\"\n  }, __jsx(\"a\", {\n    href: \"/achievements\"\n  }, \"Achievements\"))))), __jsx(Nav, null, !isLogin && __jsx(NavDropdown, {\n    title: \"Account\",\n    id: \"basic-nav-dropdown\"\n  }, __jsx(NavDropdown.Item, {\n    href: \"/signin\"\n  }, \"Sign in\"), __jsx(NavDropdown.Item, {\n    href: \"/signup\"\n  }, \"Sign up\")), isLogin && __jsx(NavDropdown, {\n    title: username,\n    id: \"basic-nav-dropdown\"\n  }, __jsx(NavDropdown.Item, {\n    onSelect: handleLogout\n  }, \"Sign out\")))));\n};\n\nexport default NavBar;","map":null,"metadata":{},"sourceType":"module"}