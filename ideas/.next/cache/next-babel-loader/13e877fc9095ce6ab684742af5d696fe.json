{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { selectArticlesState } from './states/states';\nimport { getArticles, setLogout, setBookmarks, setUserId, setUsername, setAccessToken, setProvider, setFinishedArticles, setEmail } from './actions/articlesAction';\nimport { refreshToken } from '../components/account';\n\nconst PageWrapper = ({\n  WrappedComponent\n}) => () => {\n  const disPatch = useDispatch();\n  const articles = useSelector(selectArticlesState);\n  useEffect(() => {\n    //Refresh JWT token or logout\n    refreshToken(SetLogout); //Fetch articles\n\n    if (articles.length === 0) {\n      console.log('fetch articles');\n      disPatch(getArticles());\n    } //Fetch Load bookmarks and finished articles\n\n\n    var bookmarksJson = localStorage.getItem(\"bookmarks\");\n\n    if (bookmarksJson !== null) {\n      var bookmarksList = bookmarksJson.split(',');\n      disPatch(setBookmarks(bookmarksList.filter(bookmark => bookmark !== '')));\n    }\n\n    var filterArticlesJson = localStorage.getItem(\"filterArticles\");\n\n    if (filterArticlesJson !== null) {\n      var filterArticlesList = filterArticlesJson.split(',');\n      disPatch(setFinishedArticles(filterArticlesList.filter(filterArticle => filterArticle !== '')));\n    }\n  }, []);\n\n  const SetLogout = () => {\n    disPatch(setLogout());\n    disPatch(setUsername(''));\n    disPatch(setUserId(-1));\n    disPatch(setEmail(''));\n    disPatch(setFinishedArticles([]));\n    disPatch(setAccessToken(''));\n    disPatch(setProvider(''));\n    disPatch(setBookmarks([]));\n  };\n\n  return __jsx(WrappedComponent, null);\n};\n\nexport default PageWrapper;","map":{"version":3,"sources":["/Users/seanhsieh/github/100daysOfCodeIdeas/ideas/src/components/PageWrapper.tsx"],"names":["React","useEffect","useDispatch","useSelector","selectArticlesState","getArticles","setLogout","setBookmarks","setUserId","setUsername","setAccessToken","setProvider","setFinishedArticles","setEmail","refreshToken","PageWrapper","WrappedComponent","disPatch","articles","SetLogout","length","console","log","bookmarksJson","localStorage","getItem","bookmarksList","split","filter","bookmark","filterArticlesJson","filterArticlesList","filterArticle"],"mappings":";AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAGA,SACIC,mBADJ,QAcO,iBAdP;AAgBA,SACIC,WADJ,EAKIC,SALJ,EAMIC,YANJ,EAOIC,SAPJ,EAQIC,WARJ,EASIC,cATJ,EAUIC,WAVJ,EAWIC,mBAXJ,EAYIC,QAZJ,QAaO,0BAbP;AAcA,SAASC,YAAT,QAA6B,uBAA7B;;AAGA,MAAMC,WAAiC,GAAG,CAAC;AAACC,EAAAA;AAAD,CAAD,KAAwB,MAAK;AACnE,QAAMC,QAAQ,GAAGf,WAAW,EAA5B;AACA,QAAMgB,QAAQ,GAAGf,WAAW,CAACC,mBAAD,CAA5B;AAEAH,EAAAA,SAAS,CAAC,MAAK;AACX;AACAa,IAAAA,YAAY,CAACK,SAAD,CAAZ,CAFW,CAIX;;AACA,QAAID,QAAQ,CAACE,MAAT,KAAoB,CAAxB,EAA2B;AACvBC,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAL,MAAAA,QAAQ,CAACZ,WAAW,EAAZ,CAAR;AACH,KARU,CAUX;;;AACA,QAAIkB,aAAa,GAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAApB;;AACA,QAAIF,aAAa,KAAK,IAAtB,EAA4B;AACxB,UAAIG,aAAa,GAAGH,aAAa,CAACI,KAAd,CAAoB,GAApB,CAApB;AACAV,MAAAA,QAAQ,CAACV,YAAY,CAACmB,aAAa,CAACE,MAAd,CAAqBC,QAAQ,IAAIA,QAAQ,KAAK,EAA9C,CAAD,CAAb,CAAR;AACH;;AAED,QAAIC,kBAAkB,GAAGN,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAzB;;AACA,QAAIK,kBAAkB,KAAK,IAA3B,EAAiC;AAC7B,UAAIC,kBAAkB,GAAGD,kBAAkB,CAACH,KAAnB,CAAyB,GAAzB,CAAzB;AACAV,MAAAA,QAAQ,CAACL,mBAAmB,CAACmB,kBAAkB,CAACH,MAAnB,CAA0BI,aAAa,IAAIA,aAAa,KAAK,EAA7D,CAAD,CAApB,CAAR;AACH;AACJ,GAtBQ,EAsBN,EAtBM,CAAT;;AAwBA,QAAMb,SAAS,GAAG,MAAM;AACpBF,IAAAA,QAAQ,CAACX,SAAS,EAAV,CAAR;AACAW,IAAAA,QAAQ,CAACR,WAAW,CAAC,EAAD,CAAZ,CAAR;AACAQ,IAAAA,QAAQ,CAACT,SAAS,CAAC,CAAC,CAAF,CAAV,CAAR;AACAS,IAAAA,QAAQ,CAACJ,QAAQ,CAAC,EAAD,CAAT,CAAR;AACAI,IAAAA,QAAQ,CAACL,mBAAmB,CAAC,EAAD,CAApB,CAAR;AACAK,IAAAA,QAAQ,CAACP,cAAc,CAAC,EAAD,CAAf,CAAR;AACAO,IAAAA,QAAQ,CAACN,WAAW,CAAC,EAAD,CAAZ,CAAR;AACAM,IAAAA,QAAQ,CAACV,YAAY,CAAC,EAAD,CAAb,CAAR;AACH,GATD;;AAWA,SACI,MAAC,gBAAD,OADJ;AAGH,CA1CD;;AA4CA,eAAeQ,WAAf","sourcesContent":["import React, {useEffect} from 'react'\nimport { useDispatch, useSelector } from 'react-redux';\nimport axios from 'axios';\n\nimport {\n    selectArticlesState,\n    selectPartialArticlesState,\n    selectFilteredArticlesState,\n    selectIsLoadingState,\n    selectOffsetState,\n    selectPageCountState,\n    selectPerpageState,\n    selectShowPlannerState,\n    selectProviderState,\n    selectUserIdState,\n    selectEmailState,\n    selectAccessTokenState,\n    selectLoginState\n} from './states/states';\n\nimport { \n    getArticles,\n    setPartialArticles,\n    setOffset,\n    setPageCount,\n    setLogout,\n    setBookmarks,\n    setUserId,\n    setUsername,\n    setAccessToken,\n    setProvider,\n    setFinishedArticles,\n    setEmail\n} from './actions/articlesAction';\nimport { refreshToken } from '../components/account'\nimport { PageWrapperInterface } from '../components/types'\n\nconst PageWrapper: PageWrapperInterface = ({WrappedComponent}) => ()=> {\n    const disPatch = useDispatch();\n    const articles = useSelector(selectArticlesState);\n    \n    useEffect(()=> {\n        //Refresh JWT token or logout\n        refreshToken(SetLogout);\n\n        //Fetch articles\n        if (articles.length === 0) {\n            console.log('fetch articles')\n            disPatch(getArticles());\n        }\n\n        //Fetch Load bookmarks and finished articles\n        var bookmarksJson = localStorage.getItem(\"bookmarks\");\n        if (bookmarksJson !== null) {\n            var bookmarksList = bookmarksJson.split(',');\n            disPatch(setBookmarks(bookmarksList.filter(bookmark => bookmark !== '')))\n        }\n\n        var filterArticlesJson = localStorage.getItem(\"filterArticles\");\n        if (filterArticlesJson !== null) {\n            var filterArticlesList = filterArticlesJson.split(',');\n            disPatch(setFinishedArticles(filterArticlesList.filter(filterArticle => filterArticle !== '')))\n        }\n    }, [])\n\n    const SetLogout = () => {\n        disPatch(setLogout());\n        disPatch(setUsername(''));\n        disPatch(setUserId(-1));\n        disPatch(setEmail(''));\n        disPatch(setFinishedArticles([]));\n        disPatch(setAccessToken(''));\n        disPatch(setProvider(''));\n        disPatch(setBookmarks([]));\n    }\n\n    return (\n        <WrappedComponent/>\n    )\n}\n\nexport default PageWrapper\n"]},"metadata":{},"sourceType":"module"}