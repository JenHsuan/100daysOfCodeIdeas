{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Nwme:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/signup\",function(){return a(\"smJ5\")}])},smJ5:function(e,t,a){\"use strict\";a.r(t);var n=a(\"q1tI\"),r=a.n(n),o=a(\"/MKj\"),s=a(\"8Kt/\"),c=a.n(s),i=a(\"Z4UW\"),l=a(\"o0o1\"),u=a.n(l),p=a(\"HaE+\"),m=a(\"rePB\"),d=a(\"Gwco\"),b=a.n(d),f=a(\"mlGW\"),g=a.n(f),v=(a(\"Txfo\"),a(\"vDqi\")),O=a.n(v),h=a(\"QojX\"),w=a(\"nOHt\"),j=a.n(w),k=a(\"ldY6\"),y=a(\"NUse\"),N=r.a.createElement;function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){Object(m.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var P=function(){var e=Object(o.b)(),t=Object(o.c)(k.b);Object(n.useEffect)((function(){t&&j.a.push(\"/\")}),[t]);var a=Object(n.useState)({username:\"\",email:\"\",password:\"\",messages:\"\"}),r=a[0],s=a[1],c=r.username,i=r.email,l=r.password,d=r.messages,f=function(e){return function(t){s(E(E({},r),{},Object(m.a)({},e,t.target.value.trim())))}},v=function(){var e=Object(p.a)(u.a.mark((function e(t,a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post(\"/api/social-auth\",{provider:t,access_token:a});case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(){var t=Object(p.a)(u.a.mark((function t(a){var n,o,c,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v(\"facebook\",a.accessToken);case 3:n=t.sent,console.log(n),o=n.data.token,c=n.data.username,i=a.email,x(o,i,c),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),s(E(E({},r),{},Object(m.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(y.j)());case 16:case\"end\":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}(),x=function(t,a,n){null!==t&&void 0!==t&&t.length>0&&(e(Object(y.i)()),e(Object(y.f)(t)),localStorage.setItem(\"login\",\"true\"),localStorage.setItem(\"token\",t),null!==a&&void 0!==a&&a.length>0&&(e(Object(y.h)(a)),localStorage.setItem(\"email\",a)),null!==n&&void 0!==n&&n.length>0&&(e(Object(y.o)(n)),localStorage.setItem(\"username\",n)))},P=function(){var t=Object(p.a)(u.a.mark((function t(a){var n,o,c,i,l;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.post(\"/api/get-github-access-token\",{code:a.code});case 3:return n=t.sent,console.log(n.data),t.next=7,v(\"github\",n.data);case 7:o=t.sent,console.log(o),c=o.data.token,i=o.data.email,l=o.data.username,x(c,i,l),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),console.log(t.t0),s(E(E({},r),{},Object(m.a)({},\"messages\",t.t0.message))),e(Object(y.j)());case 20:case\"end\":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),C=function(){var e=Object(p.a)(u.a.mark((function e(t){var a,n,o,p,d,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.a.post(\"/api/users/\",{username:c,password:l});case 4:if(void 0===(a=e.sent).data.error){e.next=10;break}n=a.data.error,s(E(E({},r),{},Object(m.a)({},\"messages\",\"\".concat(Object.keys(n)[0],\" : \").concat(Object.values(n)[0])))),e.next=20;break;case 10:return o=a.data.id,p=a.data.token,d={Authorization:\"JWT \".concat(p)},e.next=15,O.a.post(\"/api/profile/\",{email:i,reader:o},{headers:d});case 15:b=e.sent,console.log(b),void 0!==(n=b.data.error)&&s(E(E({},r),{},Object(m.a)({},\"messages\",\"\".concat(Object.keys(n)[0],\" : \").concat(Object.values(n)[0])))),void 0!==b&&b.data.email===i&&x(p,i,c);case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(1),s(E(E({},r),{},Object(m.a)({},\"messages\",e.t0.message))),console.log(e.t0);case 26:case\"end\":return e.stop()}}),e,null,[[1,22]])})));return function(t){return e.apply(this,arguments)}}();return N(n.Fragment,null,N(\"div\",{className:\"signinform\"},N(\"div\",{className:\"grid-box\"},N(\"div\",{className:\"title\"},\"Create Your Free Account\"),N(b.a,{cssClass:\"fb-btn\",appId:\"240314257268798\",autoLoad:!1,fields:\"name,email,picture\",callback:w,render:function(e){return N(\"button\",{onClick:e.onClick,className:\"fb-btn\"},\"Facebook\")}}),N(g.a,{className:\"github-btn\",clientId:\"51b1a8ee5b7cad1e6a85\",redirectUri:\"http://localhost:3000/signin\",onSuccess:P,onFailure:function(e){return console.error(e)},buttonText:\"Github\"}),N(\"div\",{className:\"split-line\"},\"Or signup by email\"),N(\"div\",{className:\"signin-form\"},N(h.a,{onSubmit:C},N(h.a.Group,{controlId:\"formBasicEmail\"},N(h.a.Control,{type:\"text\",placeholder:\"Enter Username\",className:\"username\",onChange:f(\"username\")})),N(h.a.Group,{controlId:\"formBasicPassword\"},N(h.a.Control,{type:\"text\",placeholder:\"Enter Email\",className:\"email\",onChange:f(\"email\")})),N(h.a.Group,{controlId:\"formBasicPassword\"},N(h.a.Control,{type:\"password\",placeholder:\"Password\",className:\"password\",onChange:f(\"password\")})),N(\"button\",{className:\"btn-submit\"},\"Get Started\"))))),N(\"div\",{className:\"messages\"},d))},C=(a(\"Stkp\"),a(\"q4sD\"),a(\"b2pr\"));!function(){var e=new Error(\"Cannot find module '../components/store/store'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var S=r.a.createElement;t.default=function(){return S(\"div\",null,S(c.a,null,S(\"title\",null,\"ALayman Learning Booster - Sign up\"),S(\"link\",{rel:\"icon\",href:\"https://raw.githubusercontent.com/JenHsuan/ALayman/master/views/images/alaymanicon.png\",type:\"image/x-icon\"})),S(o.a,{store:!function(){var e=new Error(\"Cannot find module '../components/store/store'\");throw e.code=\"MODULE_NOT_FOUND\",e}()},S(i.a,null),S(\"div\",{className:\"grid-box\"},S(P,null),S(\"div\",{className:\"signin-footer\"},S(C.a,null)))))}}},[[\"Nwme\",0,1,3,2,4,6,5]]]);","extractedComments":[]}