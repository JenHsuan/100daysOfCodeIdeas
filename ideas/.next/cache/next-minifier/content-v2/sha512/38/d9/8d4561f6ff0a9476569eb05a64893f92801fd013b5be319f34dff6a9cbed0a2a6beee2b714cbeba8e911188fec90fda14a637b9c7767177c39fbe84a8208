{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Nwme:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/signup\",function(){return a(\"smJ5\")}])},smJ5:function(e,t,a){\"use strict\";a.r(t);var n=a(\"q1tI\"),r=a.n(n),s=a(\"/MKj\"),o=a(\"8Kt/\"),c=a.n(o),i=a(\"9idV\"),l=a(\"Z4UW\"),u=a(\"o0o1\"),p=a.n(u),m=a(\"HaE+\"),b=a(\"rePB\"),d=a(\"Gwco\"),f=a.n(d),g=a(\"mlGW\"),v=a.n(g),O=(a(\"Txfo\"),a(\"vDqi\")),h=a.n(O),j=a(\"QojX\"),w=a(\"nOHt\"),k=a.n(w),y=a(\"ldY6\"),x=a(\"NUse\"),N=r.a.createElement;function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){Object(b.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S=function(){var e=Object(s.b)(),t=Object(s.c)(y.e);Object(n.useEffect)((function(){t&&k.a.push(\"/\")}),[t]);var a=Object(n.useState)({username:\"\",email:\"\",password:\"\",messages:\"\"}),r=a[0],o=a[1],c=r.username,i=r.email,l=r.password,u=r.messages,d=function(e){return function(t){o(E(E({},r),{},Object(b.a)({},e,t.target.value.trim())))}},g=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post(\"/api/social-auth\",{provider:t,access_token:a});case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),O=function(){var t=Object(m.a)(p.a.mark((function t(a){var n,s,c,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g(\"facebook\",a.accessToken);case 3:n=t.sent,console.log(n),s=n.data.token,c=n.data.username,i=a.email,w(s,i,c),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),o(E(E({},r),{},Object(b.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(x.j)());case 16:case\"end\":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}(),w=function(t,a,n){null!==t&&void 0!==t&&t.length>0&&(e(Object(x.i)()),e(Object(x.f)(t)),localStorage.setItem(\"login\",\"true\"),localStorage.setItem(\"token\",t),null!==a&&void 0!==a&&a.length>0&&(e(Object(x.h)(a)),localStorage.setItem(\"email\",a)),null!==n&&void 0!==n&&n.length>0&&(e(Object(x.o)(n)),localStorage.setItem(\"username\",n)))},P=function(){var t=Object(m.a)(p.a.mark((function t(a){var n,s,c,i,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.a.post(\"/api/get-github-access-token\",{code:a.code});case 3:return n=t.sent,console.log(n.data),t.next=7,g(\"github\",n.data);case 7:s=t.sent,console.log(s),c=s.data.token,i=s.data.email,l=s.data.username,w(c,i,l),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),console.log(t.t0),o(E(E({},r),{},Object(b.a)({},\"messages\",t.t0.message))),e(Object(x.j)());case 20:case\"end\":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),S=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n,s,u,m,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,h.a.post(\"/api/users/\",{username:c,password:l});case 4:if(void 0===(a=e.sent).data.error){e.next=10;break}n=a.data.error,o(E(E({},r),{},Object(b.a)({},\"messages\",\"\".concat(Object.keys(n)[0],\" : \").concat(Object.values(n)[0])))),e.next=20;break;case 10:return s=a.data.id,u=a.data.token,m={Authorization:\"JWT \".concat(u)},e.next=15,h.a.post(\"/api/profile/\",{email:i,reader:s},{headers:m});case 15:d=e.sent,console.log(d),void 0!==(n=d.data.error)&&o(E(E({},r),{},Object(b.a)({},\"messages\",\"\".concat(Object.keys(n)[0],\" : \").concat(Object.values(n)[0])))),void 0!==d&&d.data.email===i&&w(u,i,c);case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(1),o(E(E({},r),{},Object(b.a)({},\"messages\",e.t0.message))),console.log(e.t0);case 26:case\"end\":return e.stop()}}),e,null,[[1,22]])})));return function(t){return e.apply(this,arguments)}}();return N(n.Fragment,null,N(\"div\",{className:\"signinform\"},N(\"div\",{className:\"grid-box\"},N(\"div\",{className:\"title\"},\"Create Your Free Account\"),N(f.a,{cssClass:\"fb-btn\",appId:\"240314257268798\",autoLoad:!1,fields:\"name,email,picture\",callback:O,render:function(e){return N(\"button\",{onClick:e.onClick,className:\"fb-btn\"},\"Facebook\")}}),N(v.a,{className:\"github-btn\",clientId:\"51b1a8ee5b7cad1e6a85\",redirectUri:\"http://localhost:3000/signin\",onSuccess:P,onFailure:function(e){return console.error(e)},buttonText:\"Github\"}),N(\"div\",{className:\"split-line\"},\"Or signup by email\"),N(\"div\",{className:\"signin-form\"},N(j.a,{onSubmit:S},N(j.a.Group,{controlId:\"formBasicEmail\"},N(j.a.Control,{type:\"text\",placeholder:\"Enter Username\",className:\"username\",onChange:d(\"username\")})),N(j.a.Group,{controlId:\"formBasicPassword\"},N(j.a.Control,{type:\"text\",placeholder:\"Enter Email\",className:\"email\",onChange:d(\"email\")})),N(j.a.Group,{controlId:\"formBasicPassword\"},N(j.a.Control,{type:\"password\",placeholder:\"Password\",className:\"password\",onChange:d(\"password\")})),N(\"button\",{className:\"btn-submit\"},\"Get Started\"))))),N(\"div\",{className:\"messages\"},u))},C=(a(\"Stkp\"),a(\"q4sD\"),a(\"b2pr\")),I=r.a.createElement;t.default=function(){return I(\"div\",null,I(c.a,null,I(\"title\",null,\"ALayman Learning Booster - Sign up\"),I(\"link\",{rel:\"icon\",href:\"https://raw.githubusercontent.com/JenHsuan/ALayman/master/views/images/alaymanicon.png\",type:\"image/x-icon\"})),I(s.a,{store:i.a},I(l.a,null),I(\"div\",{className:\"grid-box\"},I(S,null),I(\"div\",{className:\"signin-footer\"},I(C.a,null)))))}}},[[\"Nwme\",0,2,4,1,3,6,5]]]);","extractedComments":[]}