{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{\"9qlI\":function(e,t,n){\"use strict\";n.r(t);var a=n(\"q1tI\"),r=n.n(a),o=n(\"/MKj\"),s=n(\"8Kt/\"),c=n.n(s),i=n(\"Z4UW\"),l=n(\"o0o1\"),u=n.n(l),p=n(\"HaE+\"),m=n(\"rePB\"),b=n(\"Gwco\"),f=n.n(b),d=n(\"mlGW\"),g=n.n(d),v=(n(\"Txfo\"),n(\"vDqi\")),O=n.n(v),h=n(\"QojX\"),w=n(\"nOHt\"),j=n.n(w),k=n(\"ldY6\"),y=n(\"NUse\"),N=r.a.createElement;function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(){var e=Object(o.b)(),t=Object(o.c)(k.c);Object(a.useEffect)((function(){t&&j.a.push(\"/\")}),[t]);var n=Object(a.useState)({username:\"\",password:\"\",messages:\"\"}),r=n[0],s=n[1],c=r.username,i=r.password,l=r.messages,b=function(e){return function(t){s(E(E({},r),{},Object(m.a)({},e,t.target.value.trim())))}},d=function(){var e=Object(p.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),console.log(t),e.next=4,O.a.post(\"/api/social-auth\",{provider:t,access_token:n});case 4:return a=e.sent,e.abrupt(\"return\",a);case 6:case\"end\":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var t=Object(p.a)(u.a.mark((function t(n){var a,o,c,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(n.accessToken),console.log(n),t.next=5,d(\"facebook\",n.accessToken);case 5:a=t.sent,console.log(a),o=a.data.token,c=a.data.username,i=n.email,w(o,i,c),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(0),s(E(E({},r),{},Object(m.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(y.j)());case 18:case\"end\":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}(),w=function(t,n,a){null!==t&&void 0!==t&&t.length>0&&(e(Object(y.i)()),e(Object(y.f)(t)),localStorage.setItem(\"login\",\"true\"),localStorage.setItem(\"token\",t),null!==n&&void 0!==n&&n.length>0&&(e(Object(y.h)(n)),localStorage.setItem(\"email\",n)),null!==a&&void 0!==a&&a.length>0&&(e(Object(y.o)(a)),localStorage.setItem(\"username\",a)))},x=function(){var t=Object(p.a)(u.a.mark((function t(n){var a,o,c,i,l;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.post(\"/api/get-github-access-token\",{code:n.code});case 3:return a=t.sent,console.log(n),t.next=7,d(\"github\",a.data);case 7:o=t.sent,console.log(o),c=o.data.token,i=o.data.email,l=o.data.username,w(c,i,l),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),s(E(E({},r),{},Object(m.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(y.j)());case 20:case\"end\":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),P=function(){var e=Object(p.a)(u.a.mark((function e(t){var n,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(c),console.log(i),e.prev=3,e.next=6,O.a.post(\"/api/token-auth/\",{username:c,password:i});case 6:n=e.sent,console.log(n.data.user.profile),a=n.data.token,o=n.data.user.profile.email,w(a,o,c),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),s(E(E({},r),{},Object(m.a)({},\"messages\",e.t0.message)));case 16:case\"end\":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return N(a.Fragment,null,N(\"div\",{className:\"signinform\"},N(\"div\",{className:\"grid-box\"},N(\"div\",{className:\"title\"},\"Welcome back!\"),N(f.a,{cssClass:\"fb-btn\",appId:\"240314257268798\",autoLoad:!1,fields:\"name,email,picture\",callback:v,render:function(e){return N(\"button\",{onClick:e.onClick,className:\"fb-btn\"},\"Facebook\")}}),N(g.a,{className:\"github-btn\",clientId:\"51b1a8ee5b7cad1e6a85\",redirectUri:\"http://localhost:3000/signin\",onSuccess:x,onFailure:function(e){return console.error(e)},buttonText:\"Github\"}),N(\"div\",{className:\"split-line\"},\"Or signin by username\"),N(\"div\",{className:\"signin-form\"},N(h.a,{onSubmit:P},N(h.a.Group,{controlId:\"formBasicEmail\"},N(h.a.Control,{type:\"text\",placeholder:\"Enter Username\",className:\"username\",onChange:b(\"username\")})),N(h.a.Group,{controlId:\"formBasicPassword\"},N(h.a.Control,{type:\"password\",placeholder:\"Password\",className:\"password\",onChange:b(\"password\")})),N(\"button\",{className:\"btn-submit\"},\"Sign in\"))))),N(\"div\",{className:\"messages\"},l))},S=(n(\"Stkp\"),n(\"q4sD\"),n(\"b2pr\"));!function(){var e=new Error(\"Cannot find module '../components/store/store'\");throw e.code=\"MODULE_NOT_FOUND\",e}();var D=r.a.createElement;t.default=function(){return D(\"div\",null,D(c.a,null,D(\"title\",null,\"ALayman Learning Booster - Sign in\"),D(\"link\",{rel:\"icon\",href:\"https://raw.githubusercontent.com/JenHsuan/ALayman/master/views/images/alaymanicon.png\",type:\"image/x-icon\"})),D(o.a,{store:!function(){var e=new Error(\"Cannot find module '../components/store/store'\");throw e.code=\"MODULE_NOT_FOUND\",e}()},D(i.a,null),D(\"div\",{className:\"grid-box\"},D(P,null),D(\"div\",{className:\"signin-footer\"},D(S.a,null)))))}},qt10:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/signin\",function(){return n(\"9qlI\")}])}},[[\"qt10\",0,1,3,2,4,6,5]]]);","extractedComments":[]}