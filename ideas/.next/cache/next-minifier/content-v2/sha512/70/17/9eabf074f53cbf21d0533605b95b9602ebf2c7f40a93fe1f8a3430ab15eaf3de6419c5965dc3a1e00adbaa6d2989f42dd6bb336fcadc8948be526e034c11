{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Nwme:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/signup\",function(){return a(\"smJ5\")}])},smJ5:function(e,t,a){\"use strict\";a.r(t);var n=a(\"q1tI\"),r=a.n(n),s=a(\"/MKj\"),o=a(\"8Kt/\"),c=a.n(o),i=a(\"9idV\"),u=a(\"Z4UW\"),l=a(\"o0o1\"),p=a.n(l),m=a(\"HaE+\"),b=a(\"rePB\"),d=a(\"Gwco\"),f=a.n(d),g=a(\"mlGW\"),v=a.n(g),O=(a(\"Txfo\"),a(\"vDqi\")),h=a.n(O),j=a(\"QojX\"),w=a(\"nOHt\"),k=a.n(w),x=a(\"ldY6\"),y=a(\"NUse\"),N=r.a.createElement;function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){Object(b.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var S=function(){var e=Object(s.b)(),t=Object(s.c)(x.g),a=Object(s.c)(x.l);Object(n.useEffect)((function(){t&&k.a.push(\"/\")}),[t]);var r=Object(n.useState)({username:\"\",email:\"\",password:\"\",messages:\"\"}),o=r[0],c=r[1],i=o.username,u=o.email,l=o.password,d=o.messages,g=function(e){return function(t){c(E(E({},o),{},Object(b.a)({},e,t.target.value.trim())))}},O=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post(\"/api/social-auth\",{provider:t,access_token:a});case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(){var t=Object(m.a)(p.a.mark((function t(a){var n,r,s,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O(\"facebook\",a.accessToken);case 3:n=t.sent,console.log(n),r=n.data.token,s=n.data.username,i=a.email,P(r,i,s),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),c(E(E({},o),{},Object(b.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(y.i)());case 16:case\"end\":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}(),P=function(t,a,n){null!==a&&void 0!==a&&a.length>0&&(e(Object(y.g)(a)),localStorage.setItem(\"email\",a)),null!==n&&void 0!==n&&n.length>0&&(e(Object(y.n)(n)),localStorage.setItem(\"username\",n)),e(Object(y.h)()),e(Object(y.e)(t)),localStorage.setItem(\"login\",\"true\")},S=function(){var t=Object(m.a)(p.a.mark((function t(a){var n,r,s,i,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.a.post(\"/api/get-github-access-token\",{code:a.code});case 3:return n=t.sent,console.log(n.data),t.next=7,O(\"github\",n.data);case 7:r=t.sent,console.log(r),s=r.data.token,i=r.data.email,u=r.data.username,P(s,i,u),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),console.log(t.t0),c(E(E({},o),{},Object(b.a)({},\"messages\",t.t0.message))),e(Object(y.i)());case 20:case\"end\":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),C=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,n,r,s,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,h.a.post(\"/api/users/\",{username:i,password:l});case 4:if(void 0===(a=e.sent).data.error){e.next=10;break}n=a.data.error,c(E(E({},o),{},Object(b.a)({},\"messages\",\"\".concat(Object.keys(n)[0],\" : \").concat(Object.values(n)[0])))),e.next=24;break;case 10:return r=a.data.id,s=a.data.token,{Authorization:\"JWT \".concat(s)},e.next=15,h.a.post(\"/api/profile/\",{email:u,reader:r});case 15:if(m=e.sent,console.log(m),void 0!==(n=m.data.error)&&c(E(E({},o),{},Object(b.a)({},\"messages\",\"\".concat(Object.keys(n)[0],\" : \").concat(Object.values(n)[0])))),void 0===m||m.data.email!==u){e.next=24;break}return e.next=22,h.a.post(\"/api/token-auth/\",{username:i,password:l});case 22:e.sent,P(s,u,i);case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(1),c(E(E({},o),{},Object(b.a)({},\"messages\",e.t0.message))),console.log(e.t0);case 30:case\"end\":return e.stop()}}),e,null,[[1,26]])})));return function(t){return e.apply(this,arguments)}}();return N(n.Fragment,null,N(\"div\",{className:\"\".concat(!0===a?\"signinform-move-left signinform\":\"signinform\")},N(\"div\",{className:\"signinform-grid-box\"},N(\"div\",{className:\"title\"},\"Create Your Free Account\"),N(f.a,{cssClass:\"fb-btn\",appId:\"240314257268798\",autoLoad:!1,fields:\"name,email,picture\",callback:w,render:function(e){return N(\"button\",{onClick:e.onClick,className:\"fb-btn\"},\"Facebook\")}}),N(v.a,{className:\"github-btn\",clientId:\"51b1a8ee5b7cad1e6a85\",redirectUri:\"http://localhost:3000/signin\",onSuccess:S,onFailure:function(e){return console.error(e)},buttonText:\"Github\"}),N(\"div\",{className:\"split-line\"},\"Or signup by email\"),N(\"div\",{className:\"signin-form\"},N(j.a,{onSubmit:C},N(j.a.Group,{controlId:\"formBasicEmail\"},N(j.a.Control,{type:\"text\",placeholder:\"Enter Username\",className:\"username\",onChange:g(\"username\")})),N(j.a.Group,{controlId:\"formBasicPassword\"},N(j.a.Control,{type:\"text\",placeholder:\"Enter Email\",className:\"email\",onChange:g(\"email\")})),N(j.a.Group,{controlId:\"formBasicPassword\"},N(j.a.Control,{type:\"password\",placeholder:\"Password\",className:\"password\",onChange:g(\"password\")})),N(\"button\",{className:\"btn-submit\"},\"Get Started\"))),N(\"div\",{className:\"messages\"},d))))},C=(a(\"Stkp\"),a(\"q4sD\"),a(\"b2pr\")),I=a(\"xrSH\"),D=(a(\"v+B1\"),r.a.createElement);t.default=function(){return D(\"div\",null,D(c.a,null,D(\"title\",null,\"ALayman Learning Booster - Sign up\"),D(\"link\",{rel:\"icon\",href:\"https://raw.githubusercontent.com/JenHsuan/ALayman/master/views/images/alaymanicon.png\",type:\"image/x-icon\"})),D(s.a,{store:i.a},D(u.a,null),D(\"div\",{className:\"grid-box\"},D(I.a,null),D(S,null),D(\"div\",{className:\"signin-footer\"},D(C.a,null)))))}}},[[\"Nwme\",0,2,3,1,4,6,5]]]);","extractedComments":[]}