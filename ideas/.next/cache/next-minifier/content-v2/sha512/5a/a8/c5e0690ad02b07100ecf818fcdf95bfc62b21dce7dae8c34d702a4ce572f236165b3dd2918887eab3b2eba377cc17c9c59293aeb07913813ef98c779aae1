{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{\"9qlI\":function(e,t,n){\"use strict\";n.r(t);var a=n(\"q1tI\"),r=n.n(a),s=n(\"/MKj\"),o=n(\"8Kt/\"),c=n.n(o),i=n(\"9idV\"),l=n(\"Z4UW\"),u=n(\"o0o1\"),p=n.n(u),m=n(\"HaE+\"),b=n(\"rePB\"),f=n(\"Gwco\"),d=n.n(f),g=n(\"mlGW\"),v=n.n(g),O=(n(\"Txfo\"),n(\"vDqi\")),h=n.n(O),j=n(\"T/rR\"),w=n(\"QojX\"),k=n(\"nOHt\"),x=n.n(k),y=n(\"ldY6\"),N=n(\"NUse\"),P=r.a.createElement;function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){Object(b.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(){var e=Object(s.b)(),t=Object(s.c)(y.g),n=Object(s.c)(y.l),r=Object(s.c)(y.b),o=Object(a.useState)(!1),c=o[0],i=o[1];Object(a.useEffect)((function(){0===r.length&&(console.log(\"fetch articles\"),e(Object(N.c)()))}),[]),Object(a.useEffect)((function(){t&&x.a.push(\"/\")}),[t]);var l=Object(a.useState)({username:\"\",password:\"\",messages:\"\"}),u=l[0],f=l[1],g=u.username,O=u.password,k=u.messages,S=function(e){return function(t){f(E(E({},u),{},Object(b.a)({},e,t.target.value.trim())))}},I=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),console.log(t),e.next=4,h.a.post(\"/api/social-auth\",{provider:t,access_token:n});case 4:return a=e.sent,e.abrupt(\"return\",a);case 6:case\"end\":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var t=Object(m.a)(p.a.mark((function t(n){var a,r,s,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i(!0),console.log(n.accessToken),console.log(n),t.next=6,I(\"facebook\",n.accessToken);case 6:a=t.sent,console.log(a),r=a.data.token,s=a.data.username,o=n.email,q(r,o,s),i(!1),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),f(E(E({},u),{},Object(b.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(N.i)());case 20:case\"end\":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),q=function(t,n,a){null!==n&&void 0!==n&&n.length>0&&(e(Object(N.g)(n)),localStorage.setItem(\"email\",n)),null!==a&&void 0!==a&&a.length>0&&(e(Object(N.n)(a)),localStorage.setItem(\"username\",a)),e(Object(N.h)()),e(Object(N.e)(t)),localStorage.setItem(\"login\",\"true\")},C=function(){var t=Object(m.a)(p.a.mark((function t(n){var a,r,s,o,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i(!0),t.next=4,h.a.post(\"/api/get-github-access-token\",{code:n.code});case 4:return a=t.sent,console.log(n),t.next=8,I(\"github\",a.data);case 8:r=t.sent,console.log(r),s=r.data.token,o=r.data.email,c=r.data.username,q(s,o,c),i(!1),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),f(E(E({},u),{},Object(b.a)({},\"messages\",t.t0.message))),console.log(t.t0),e(Object(N.i)());case 22:case\"end\":return t.stop()}}),t,null,[[0,17]])})));return function(e){return t.apply(this,arguments)}}(),D=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(g),console.log(O),e.prev=3,i(!0),e.next=7,h.a.post(\"/api/token-auth/\",{username:g,password:O});case 7:n=e.sent,console.log(n.data.user.profile),a=n.data.token,r=n.data.user.profile.email,q(a,r,g),i(!1),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),f(E(E({},u),{},Object(b.a)({},\"messages\",e.t0.message)));case 18:case\"end\":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}();return P(a.Fragment,null,P(\"div\",{className:\"\".concat(!0===n?\"signinform-move-left signinform\":\"signinform\")},!0===c?P(\"div\",{className:\"signinform-grid-box\"},P(\"div\",{className:\"signinform-spinner\"},P(j.a,{animation:\"border\",role:\"status\"},P(\"span\",{className:\"sr-only\"},\"Loading...\")))):P(\"div\",{className:\"signinform-grid-box\"},P(\"div\",{className:\"title\"},\"Welcome back!\"),P(d.a,{cssClass:\"fb-btn\",appId:\"240314257268798\",autoLoad:!1,fields:\"name,email,picture\",callback:T,render:function(e){return P(\"button\",{onClick:e.onClick,className:\"fb-btn\"},\"Facebook\")}}),P(v.a,{className:\"github-btn\",clientId:\"51b1a8ee5b7cad1e6a85\",redirectUri:\"http://localhost:3000/signin\",onSuccess:C,onFailure:function(e){return console.error(e)},buttonText:\"Github\"}),P(\"div\",{className:\"split-line\"},\"Or signin by username\"),P(\"div\",{className:\"signin-form\"},P(w.a,{onSubmit:D},P(w.a.Group,{controlId:\"formBasicEmail\"},P(w.a.Control,{type:\"text\",placeholder:\"Enter Username\",className:\"username\",onChange:S(\"username\")})),P(w.a.Group,{controlId:\"formBasicPassword\"},P(w.a.Control,{type:\"password\",placeholder:\"Password\",className:\"password\",onChange:S(\"password\")})),P(\"button\",{className:\"btn-submit\"},\"Sign in\"))),P(\"div\",{className:\"messages\"},k))))},T=(n(\"Stkp\"),n(\"v+B1\"),n(\"q4sD\"),n(\"b2pr\")),q=n(\"xrSH\"),C=r.a.createElement;t.default=function(){return C(\"div\",null,C(c.a,null,C(\"title\",null,\"ALayman Learning Booster - Sign in\"),C(\"link\",{rel:\"icon\",href:\"https://raw.githubusercontent.com/JenHsuan/ALayman/master/views/images/alaymanicon.png\",type:\"image/x-icon\"})),C(s.a,{store:i.a},C(l.a,null),C(\"div\",{className:\"grid-box\"},C(q.a,null),C(I,null),C(\"div\",{className:\"signin-footer\"},C(T.a,null)))))}},\"T/rR\":function(e,t,n){\"use strict\";var a=n(\"wx14\"),r=n(\"zLVn\"),s=n(\"TSYQ\"),o=n.n(s),c=n(\"q1tI\"),i=n.n(c),l=n(\"vUet\"),u=i.a.forwardRef((function(e,t){var n=e.bsPrefix,s=e.variant,c=e.animation,u=e.size,p=e.children,m=e.as,b=void 0===m?\"div\":m,f=e.className,d=Object(r.a)(e,[\"bsPrefix\",\"variant\",\"animation\",\"size\",\"children\",\"as\",\"className\"]),g=(n=Object(l.b)(n,\"spinner\"))+\"-\"+c;return i.a.createElement(b,Object(a.a)({ref:t},d,{className:o()(f,g,u&&g+\"-\"+u,s&&\"text-\"+s)}),p)}));u.displayName=\"Spinner\",t.a=u},qt10:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/signin\",function(){return n(\"9qlI\")}])}},[[\"qt10\",0,2,4,1,3,6,5]]]);","extractedComments":[]}